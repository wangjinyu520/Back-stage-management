webpackJsonp([45],{"0d1n":function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l("woOf"),n=l.n(a),i=l("WU8w"),o=l("xT6B"),s=l("KA92"),r=[{label:"一级类目",value:1},{label:"二级类目",value:2}],c={pageNum:1,pageSize:5,keyword:null},u={typeName:null,parentId:null,level:null,sortIndex:null,file:null},d={name:"flashPromotionList",data:function(){return{uploadPath:s.c,listQuery:n()({},c),firstProductTypeList:[],list:null,levelOptions:n()({},r),total:null,listLoading:!1,dialogVisible:!1,flashPromotion:n()({},u),isEdit:!1}},created:function(){this.getList()},filters:{levelFilter:function(t){return 1===t?"一级":2===t?"二级":void 0},formatActiveStatus:function(t){var e=(new Date).getTime();return e>=t.startDate&&e<=t.endDate?"活动进行中":e>t.endDate?"活动已结束":"活动未开始"},formatDate:function(t){if(null==t||""===t)return"N/A";var e=new Date(t);return Object(o.a)(e,"yyyy-MM-dd")}},methods:{tirggerTypeIcon:function(t){console.log("tirggerTypeIcon"),this.flashPromotion.file=t.raw,void 0!=window.createObjectURL?this.flashPromotion.imageUrl=window.createObjectURL(t.raw):void 0!=window.URL?this.flashPromotion.imageUrl=window.URL.createObjectURL(t.raw):void 0!=window.webkitURL&&(this.flashPromotion.imageUrl=window.webkitURL.createObjectURL(t.raw))},getFirstProductTypeList:function(){var t=this;Object(i.c)({pageSize:100,pageNum:1}).then(function(e){t.firstProductTypeList=e.data})},handleResetSearch:function(){this.listQuery=n()({},c)},handleSearchList:function(){this.listQuery.pageNum=1,this.getList()},handleSizeChange:function(t){this.listQuery.pageNum=1,this.listQuery.pageSize=t,this.getList()},handleCurrentChange:function(t){this.listQuery.pageNum=t,this.getList()},handleAdd:function(){this.getFirstProductTypeList(),this.dialogVisible=!0,this.isEdit=!1,this.flashPromotion=n()({},u)},handleShowSessionList:function(){this.$router.push({path:"/sms/flashSession"})},handleStatusChange:function(t,e){var l=this;this.$confirm("是否要修改该状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.f)(e.id,{status:e.status}).then(function(t){l.$message({type:"success",message:"修改成功!"})})}).catch(function(){l.$message({type:"info",message:"取消修改"}),l.getList()})},handleDelete:function(t,e){var l=this;this.$confirm("是否要删除该类型?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.b)(e.typeId).then(function(t){l.$message({type:"success",message:"删除成功!"}),l.getList()})})},handleUpdate:function(t,e){this.dialogVisible=!0,this.isEdit=!0,this.flashPromotion=n()({},e)},handleDialogConfirm:function(){var t=this;this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(t.isEdit){console.log(t.flashPromotion);var e=new FormData;e.append("typeName",t.flashPromotion.typeName),e.append("parentId",t.flashPromotion.parentId),e.append("level",t.flashPromotion.level),e.append("sortIndex",t.flashPromotion.sortIndex),e.append("file",t.flashPromotion.file),Object(i.e)(t.flashPromotion.typeId,e).then(function(e){t.$message({message:"修改成功！",type:"success"}),t.dialogVisible=!1,t.getList()})}else{var l=new FormData;l.append("typeName",t.flashPromotion.typeName),l.append("parentId",t.flashPromotion.parentId),l.append("level",t.flashPromotion.level),l.append("sortIndex",t.flashPromotion.sortIndex),l.append("file",t.flashPromotion.file),Object(i.a)(l).then(function(e){t.$message({message:"添加成功！",type:"success"}),t.dialogVisible=!1,t.getList()})}})},handleSelectSession:function(t,e){this.$router.push({path:"/sms/selectSession",query:{flashPromotionId:e.id}})},getList:function(){var t=this;this.listLoading=!0,Object(i.c)(this.listQuery).then(function(e){t.listLoading=!1,t.list=e.data,t.total=e.total})}}},f={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"app-container"},[l("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[l("div",[l("i",{staticClass:"el-icon-search"}),t._v(" "),l("span",[t._v("筛选搜索")]),t._v(" "),l("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleSearchList()}}},[t._v("\n        查询搜索\n      ")]),t._v(" "),l("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(e){return t.handleResetSearch()}}},[t._v("\n        重置\n      ")])],1),t._v(" "),l("div",{staticStyle:{"margin-top":"15px"}},[l("el-form",{attrs:{inline:!0,model:t.listQuery,size:"small","label-width":"140px"}},[l("el-form-item",{attrs:{label:"类型名称："}},[l("el-input",{staticClass:"input-width",attrs:{placeholder:"类型名称",clearable:""},model:{value:t.listQuery.typeName,callback:function(e){t.$set(t.listQuery,"typeName",e)},expression:"listQuery.typeName"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"层级"}},[l("el-select",{model:{value:t.listQuery.level,callback:function(e){t.$set(t.listQuery,"level",e)},expression:"listQuery.level"}},t._l(t.levelOptions,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1)]),t._v(" "),l("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[l("i",{staticClass:"el-icon-tickets"}),t._v(" "),l("span",[t._v("数据列表")]),t._v(" "),l("el-button",{staticClass:"btn-add",staticStyle:{"margin-left":"20px"},attrs:{size:"mini"},on:{click:function(e){return t.handleAdd()}}},[t._v("添加类型")])],1),t._v(" "),l("div",{staticClass:"table-container"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"flashTable",staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[l("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),t._v(" "),l("el-table-column",{attrs:{label:"编号",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.typeId))]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"类型名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.typeName))]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"排序位置",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.sortIndex))]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"级别",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("levelFilter")(e.row.level)))]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"父级编号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.parentId))]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"图片",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[l("img",{staticStyle:{height:"80px"},attrs:{src:t.row.imageUrl}})]}}])}),t._v(" "),l("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(l){return t.handleUpdate(e.$index,e.row)}}},[t._v("\n            编辑\n          ")]),t._v(" "),l("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(l){return t.handleDelete(e.$index,e.row)}}},[t._v("删除\n          ")])]}}])})],1)],1),t._v(" "),l("div",{staticClass:"pagination-container"},[l("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","current-page":t.listQuery.pageNum,"page-size":t.listQuery.pageSize,"page-sizes":[5,10,15],total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.listQuery,"pageNum",e)},"update:current-page":function(e){return t.$set(t.listQuery,"pageNum",e)}}})],1),t._v(" "),l("el-dialog",{attrs:{title:"添加/修改类型",visible:t.dialogVisible,width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[l("el-form",{ref:"flashPromotionForm",attrs:{model:t.flashPromotion,"label-width":"150px",size:"small"}},[l("el-form-item",{attrs:{label:"类型名称："}},[l("el-input",{staticStyle:{width:"210px"},model:{value:t.flashPromotion.typeName,callback:function(e){t.$set(t.flashPromotion,"typeName",e)},expression:"flashPromotion.typeName"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"层级："}},[l("el-select",{model:{value:t.flashPromotion.level,callback:function(e){t.$set(t.flashPromotion,"level",e)},expression:"flashPromotion.level"}},t._l(t.levelOptions,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),2==t.flashPromotion.level?l("el-form-item",{attrs:{label:"上级分类："}},[l("el-select",{attrs:{placeholder:"请选择分类"},model:{value:t.flashPromotion.parentId,callback:function(e){t.$set(t.flashPromotion,"parentId",e)},expression:"flashPromotion.parentId"}},t._l(t.firstProductTypeList,function(t){return l("el-option",{key:t.id,attrs:{label:t.typeName,value:t.typeId}})}),1)],1):t._e(),t._v(" "),l("el-form-item",{attrs:{label:"排序位置："}},[l("el-input",{staticStyle:{width:"210px"},model:{value:t.flashPromotion.sortIndex,callback:function(e){t.$set(t.flashPromotion,"sortIndex",e)},expression:"flashPromotion.sortIndex"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"商品图片"}},[l("el-upload",{staticClass:"avatar-uploader",attrs:{action:"none","show-file-list":!1,"on-change":t.tirggerTypeIcon,accept:".jpg,.jpeg,.png,.gif"}},[t.flashPromotion.imageUrl?l("img",{staticClass:"avatar",attrs:{src:t.flashPromotion.imageUrl}}):l("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),l("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleDialogConfirm()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=l("VU/8")(d,f,!1,function(t){l("Q07p")},null,null);e.default=p.exports},Q07p:function(t,e){}});
//# sourceMappingURL=45.91aca82bb9567457f1e9.js.map