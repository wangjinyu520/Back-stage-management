webpackJsonp([20],{"6sJn":function(e,t){},LLia:function(e,t,a){"use strict";t.c=function(e){return Object(n.a)({url:"/purchaseRule/getPurchaseRuleList",method:"get",params:e})},t.b=function(e){return Object(n.a)({url:"/purchaseRule/delete",method:"post",data:e})},t.a=function(e){return Object(n.a)({url:"/purchaseRule/addPurchaseRule",method:"post",data:e})},t.d=function(e,t){return Object(n.a)({url:"/purchaseRule/modifyPurchaseRule/"+e,method:"post",data:t})};var n=a("vLgD")},caBC:function(e,t,a){"use strict";t.a=function(e,t){return Object(n.a)({url:"/stock/modifyStock/"+e,method:"get",params:t})},t.b=function(e,t){return Object(n.a)({url:"/sku/update/"+e,method:"post",data:t})};var n=a("vLgD")},gEzv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),l=a.n(n),s=a("UgCr"),i=a("caBC"),o=(a("LLia"),a("s/Rn")),u=a("WU8w"),r={keyword:null,pageNum:1,pageSize:5,publishStatus:null,verifyStatus:null,productSn:null,productCategoryId:null,brandId:null},c={name:"productList",data:function(){return{editSkuInfo:{dialogVisible:!1,productId:null,productSn:"",productAttributeCategoryId:null,stockList:[],keyword:null,specifications:["标准"]},operates:[{label:"商品上架",value:"publishOn"},{label:"商品下架",value:"publishOff"},{label:"设为推荐",value:"recommendOn"},{label:"取消推荐",value:"recommendOff"},{label:"删除",value:"recycle"}],operateType:null,listQuery:l()({},r),list:null,total:null,listLoading:!0,selectProductCateValue:null,multipleSelection:[],productTypeOptions:[],brandOptions:[],publishStatusOptions:[{value:2,label:"上架"},{value:4,label:"下架"}],verifyStatusOptions:[{value:2,label:"审核通过"},{value:1,label:"待审核"}]}},created:function(){this.getList(),this.getBrandList(),this.getProductCateList()},watch:{selectProductCateValue:function(e){null!=e&&2==e.length?this.listQuery.productType=e[1]:this.listQuery.productType=null}},filters:{verifyStatusFilter:function(e){return 1===e?"待审核":2===e?"上架":3===e?"被驳回":4===e?"下架":"待初审"}},methods:{getProductSkuSp:function(e,t){return 0===t?e.sp1:1===t?e.sp2:e.sp3},getList:function(){var e=this;this.listLoading=!0,Object(s.f)(this.listQuery).then(function(t){e.listLoading=!1,e.list=t.data,e.total=t.total})},getBrandList:function(){var e=this;Object(o.c)({pageNum:1,pageSize:100}).then(function(t){e.brandOptions=[];for(var a=t.data,n=0;n<a.length;n++)e.brandOptions.push({label:a[n].brandName,value:a[n].brandId})})},getProductCateList:function(){var e=this;Object(u.d)().then(function(t){var a=t.data;e.productTypeOptions=[];for(var n=0;n<a.length;n++){var l=[];if(null!=a[n].children&&a[n].children.length>0)for(var s=0;s<a[n].children.length;s++)l.push({label:a[n].children[s].typeName,value:a[n].children[s].typeId});e.productTypeOptions.push({label:a[n].typeName,value:a[n].typeId,children:l})}})},handleShowSkuEditDialog:function(e,t){var a=this;this.editSkuInfo.dialogVisible=!0,this.editSkuInfo.productId=t.productId,this.editSkuInfo.productSn=t.productSn,this.editSkuInfo.specifications=t.specifications,this.editSkuInfo.keyword=null,Object(i.a)(t.productId,{keyword:this.editSkuInfo.keyword}).then(function(e){a.editSkuInfo.stockList=e.data})},handleSearchEditSku:function(){var e=this;Object(i.a)(this.editSkuInfo.productId,{stockId:this.editSkuInfo.keyword}).then(function(t){e.editSkuInfo.stockList=t.data})},handleEditSkuConfirm:function(){var e=this;null==this.editSkuInfo.stockList||this.editSkuInfo.stockList.length<=0?this.$message({message:"暂无sku信息",type:"warning",duration:1e3}):this.$confirm("是否要进行修改","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log(e.editSkuInfo),Object(i.b)(e.editSkuInfo.productId,e.editSkuInfo.stockList).then(function(t){e.$message({message:"修改成功",type:"success",duration:1e3}),e.editSkuInfo.dialogVisible=!1})})},handleSearchList:function(){this.listQuery.pageNum=1,this.getList()},handleAddProduct:function(){this.$router.push({path:"/pms/addProduct"})},handleBatchOperate:function(){var e=this;null!=this.operateType?null==this.multipleSelection||this.multipleSelection.length<1?this.$message({message:"请选择要操作的商品",type:"warning",duration:1e3}):this.$confirm("是否要进行该批量操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=[],a=0;a<e.multipleSelection.length;a++)t.push(e.multipleSelection[a].productId);switch(e.operateType){case e.operates[0].value:e.batchUpdatePublishStatus(2,t);break;case e.operates[1].value:e.batchUpdatePublishStatus(4,t);break;case e.operates[2].value:console.log("设为推荐"),e.batchUpdateRecommendStatus(1,t);break;case e.operates[3].value:console.log("取消推荐"),e.batchDeleteRecommendStatus(0,t);break;case e.operates[4].value:console.log("批量删除"),e.batchDelete(t);break;case e.operates[5].value:case e.operates[6].value:case e.operates[7].value:}e.getList()}):this.$message({message:"请选择操作类型",type:"warning",duration:1e3})},handleSizeChange:function(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getList()},handleSelectionChange:function(e){this.multipleSelection=e},handlePublishStatusChange:function(e,t){var a=[];a.push(t.productId),this.updatePublishStatus(t.isOnSale,a)},handleNewStatusChange:function(e,t){var a=[];a.push(t.productId),this.updateNewStatus(t.isScoreProduct,a)},handleRecommendStatusChange:function(e,t){var a=[];a.push(t.id),this.updateRecommendStatus(t.recommandStatus,a)},handleResetSearch:function(){this.selectProductCateValue=[],this.listQuery=l()({},r)},handleDelete:function(e,t){var a=this;this.$confirm("是否要进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];e.push(t.productId),a.updateDeleteStatus(1,e),a.getList()})},handleUpdateProduct:function(e,t){this.$router.push({path:"/pms/updateProduct",query:{id:t.productId}})},handleShowProduct:function(e,t){console.log("handleShowProduct",t),this.$router.push({path:"/pms/updateProduct",query:{id:t.productId}})},handleShowVerifyDetail:function(e,t){console.log("handleShowVerifyDetail",t)},handleShowLog:function(e,t){console.log("handleShowLog",t)},updatePublishStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("isOnSale",e),Object(s.k)(n).then(function(e){a.$message({message:"修改成功",type:"success",duration:1e3})})},updateNewStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("isScoreProduct",e),Object(s.i)(n).then(function(e){a.$message({message:"修改成功",type:"success",duration:1e3})})},updateRecommendStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("recommendStatus",e),Object(s.l)(n).then(function(e){a.$message({message:"修改成功",type:"success",duration:1e3})})},batchDeleteRecommendStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("recommendStatus",e),Object(s.b)(n).then(function(e){a.$message({message:"设置成功",type:"success",duration:1e3})})},batchUpdateRecommendStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("recommendStatus",e),Object(s.d)(n).then(function(e){a.$message({message:"设置成功",type:"success",duration:1e3})})},batchUpdatePublishStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("ids",t),n.append("isOnSale",e),Object(s.c)(n).then(function(e){a.$message({message:"修改成功",type:"success",duration:1e3})})},batchDelete:function(e){var t=this,a=new URLSearchParams;a.append("productIds",e),Object(s.a)(a).then(function(e){t.$message({message:"删除成功",type:"success",duration:1e3}),t.getList()})},updateDeleteStatus:function(e,t){var a=this,n=new URLSearchParams;n.append("productId",t),n.append("deleteStatus",e),Object(s.h)(n).then(function(e){a.$message({message:"删除成功",type:"success",duration:1e3})}),this.getList()}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[a("div",[a("i",{staticClass:"el-icon-search"}),e._v(" "),a("span",[e._v("筛选搜索")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearchList()}}},[e._v("\n        查询结果\n      ")]),e._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){return e.handleResetSearch()}}},[e._v("\n        重置\n      ")])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[a("el-form",{attrs:{inline:!0,model:e.listQuery,size:"small","label-width":"140px"}},[a("el-form-item",{attrs:{label:"输入搜索："}},[a("el-input",{staticStyle:{width:"203px"},attrs:{placeholder:"商品名称"},model:{value:e.listQuery.productName,callback:function(t){e.$set(e.listQuery,"productName",t)},expression:"listQuery.productName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品货号："}},[a("el-input",{staticStyle:{width:"203px"},attrs:{placeholder:"商品编号"},model:{value:e.listQuery.productId,callback:function(t){e.$set(e.listQuery,"productId",t)},expression:"listQuery.productId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品分类："}},[a("el-cascader",{attrs:{clearable:"",options:e.productTypeOptions},model:{value:e.selectProductCateValue,callback:function(t){e.selectProductCateValue=t},expression:"selectProductCateValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品品牌："}},[a("el-select",{attrs:{placeholder:"请选择品牌",clearable:""},model:{value:e.listQuery.brandId,callback:function(t){e.$set(e.listQuery,"brandId",t)},expression:"listQuery.brandId"}},e._l(e.brandOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上架状态："}},[a("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.listQuery.publishStatus,callback:function(t){e.$set(e.listQuery,"publishStatus",t)},expression:"listQuery.publishStatus"}},e._l(e.publishStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审核状态："}},[a("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.listQuery.verifyStatus,callback:function(t){e.$set(e.listQuery,"verifyStatus",t)},expression:"listQuery.verifyStatus"}},e._l(e.verifyStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)]),e._v(" "),a("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[a("i",{staticClass:"el-icon-tickets"}),e._v(" "),a("span",[e._v("数据列表")]),e._v(" "),a("el-button",{staticClass:"btn-add",attrs:{size:"mini"},on:{click:function(t){return e.handleAddProduct()}}},[e._v("\n      添加\n    ")])],1),e._v(" "),a("div",{staticClass:"table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"productTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"编号",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.productId))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商品图片",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{height:"80px"},attrs:{src:e.row.productIcon}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商品名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.productName))]),e._v(" "),a("p",[e._v("品牌："+e._s(t.row.brandName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"价格/货号",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("价格：￥"+e._s(t.row.salePrice))]),e._v(" "),a("p",[e._v("货号："+e._s(t.row.productId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标签",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("上架：\n            "),a("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},on:{change:function(a){return e.handlePublishStatusChange(t.$index,t.row)}},model:{value:t.row.isOnSale,callback:function(a){e.$set(t.row,"isOnSale",a)},expression:"scope.row.isOnSale"}})],1),e._v(" "),a("p",[e._v("积分：\n            "),a("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},on:{change:function(a){return e.handleNewStatusChange(t.$index,t.row)}},model:{value:t.row.isScoreProduct,callback:function(a){e.$set(t.row,"isScoreProduct",a)},expression:"scope.row.isScoreProduct"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"审核状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(e._f("verifyStatusFilter")(t.row.activated)))]),e._v(" "),a("p",[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleShowVerifyDetail(t.$index,t.row)}}},[e._v("审核详情\n            ")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleShowProduct(t.$index,t.row)}}},[e._v("查看\n            ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleUpdateProduct(t.$index,t.row)}}},[e._v("编辑\n            ")])],1),e._v(" "),a("p",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleShowLog(t.$index,t.row)}}},[e._v("日志\n            ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除\n            ")])],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"batch-operate-container"},[a("el-select",{attrs:{size:"small",placeholder:"批量操作"},model:{value:e.operateType,callback:function(t){e.operateType=t},expression:"operateType"}},e._l(e.operates,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-button",{staticClass:"search-button",staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleBatchOperate()}}},[e._v("\n      确定\n    ")])],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","page-size":e.listQuery.pageSize,"page-sizes":[5,10,15],"current-page":e.listQuery.pageNum,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.listQuery,"pageNum",t)},"update:current-page":function(t){return e.$set(e.listQuery,"pageNum",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑货品信息",visible:e.editSkuInfo.dialogVisible,width:"40%"},on:{"update:visible":function(t){return e.$set(e.editSkuInfo,"dialogVisible",t)}}},[a("span",[e._v("商品货号：")]),e._v(" "),a("span",[e._v(e._s(e.editSkuInfo.productSn))]),e._v(" "),a("el-input",{staticStyle:{width:"50%","margin-left":"20px"},attrs:{placeholder:"按sku编号搜索",size:"small"},model:{value:e.editSkuInfo.keyword,callback:function(t){e.$set(e.editSkuInfo,"keyword",t)},expression:"editSkuInfo.keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearchEditSku},slot:"append"})],1),e._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.editSkuInfo.stockList,border:""}},[a("el-table-column",{attrs:{label:"SKU编号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n         "+e._s(t.row.stockId)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"value",label:"货品规格"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.specifications,function(t){return a("el-tag",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"销售价格",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.salePrice,callback:function(a){e.$set(t.row,"salePrice",a)},expression:"scope.row.salePrice"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商品库存",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.stock,callback:function(a){e.$set(t.row,"stock",a)},expression:"scope.row.stock"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"库存预警值",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.lowStock,callback:function(a){e.$set(t.row,"lowStock",a)},expression:"scope.row.lowStock"}})]}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editSkuInfo.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleEditSkuConfirm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("6sJn")},null,null);t.default=p.exports}});
//# sourceMappingURL=20.b4e5ad2e0cb4f3ae6c1b.js.map