webpackJsonp([22],{"Q+Er":function(e,t){},VDtI:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("mvHQ"),s=i.n(o),a=i("woOf"),r=i.n(a),c=i("bOdI"),l=i.n(c),n=i("G0J2"),d=i("+yKa"),m=(i("3f40"),i("4qOc"),i("+cgv"),i("wc4o")),u=i("KA92"),p=i("iB2v"),h=i("zL8q"),f=(i("z0xl"),{name:"ProductCreate",components:{Editor:p.a,quillEditor:n.quillEditor},data:function(){var e;return e={params:new FormData,dialogImageUrl:"",dialogVisible:!1,picList:[],fileList:[],uploadPath:u.c,newKeywordVisible:!1,newKeyword:"",selectProductCateValue:null,brandOptions:[],productTypeOptions:[],commodityTypeOptions:[],commodity:{productIcon:"",commodityType:"",commodityName:"",rent:"",unit:"",companyId:""},specVisiable:!1,specForm:{specification:"",value:""},multipleSpec:!1,specification:[{specification:"规格",value:"标准"}]},l()(e,"commodityTypeOptions",[{value:1,label:"灯光"},{value:2,label:"音响"},{value:3,label:"视频"}]),l()(e,"productVisiable",!1),l()(e,"productForm",{id:0,specification:[],salePrice:0,stock:99,url:""}),l()(e,"stocks",[{specification:["标准"],salePrice:0,stock:99,url:""}]),l()(e,"attributeVisiable",!1),l()(e,"attributeForm",{attribute:"",value:""}),l()(e,"attributes",[]),l()(e,"quillOption",d.a),l()(e,"rules",{merchantId:[{required:!0,message:"供货商家编号不能为空",trigger:"blur"}],commodityName:[{required:!0,message:"严选商品名称不能为空",trigger:"blur"}],rent:[{required:!0,message:"租赁金额不能为空",trigger:"blur"}],companyId:[{required:!0,message:"商品所属不能为空",trigger:"blur"}],brand:[{required:!0,message:"商品型号不能为空",trigger:"blur"}],model:[{required:!0,message:"商品型号不能为空",trigger:"blur"}],power:[{required:!0,message:"商品功率不能为空",trigger:"blur"}],specification:[{required:!0,message:"商品规格不能为空",trigger:"blur"}],unit:[{required:!0,message:"租赁单位不能为空",trigger:"blur"}]}),l()(e,"editorInit",{language:"zh_CN",convert_urls:!1,plugins:["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],toolbar:["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],images_upload_handler:function(e,t,i){var o=new FormData;o.append("file",e.blob()),Object(u.b)(o).then(function(e){t(e.data)}).catch(function(){i("上传失败，请重新上传")})}}),e},watch:{},methods:{handleResetSearch:function(){this.selectProductCateValue=[],this.listQuery=r()({},defaultListQuery)},handleCancel:function(){this.$router.push({path:"/pms/product"})},handlePublish:function(){var e=this;""!==this.commodity.commodityType?(this.commodity.companyId=this.$store.getters.userId,this.params.append("stocks",s()(this.stocks)),this.params.append("commodity",s()(this.commodity)),this.params.append("specification",s()(this.specification)),this.params.append("attributes",s()(this.attributes)),console.log("stocks："+s()(this.stocks)),console.log("commodity："+s()(this.commodity)),console.log("commodityType："+this.commodity.commodityType),console.log("companyId："+this.commodity.companyId),Object(m.e)(this.params).then(function(t){e.$notify.success({title:"成功",message:"创建成功"}),e.$router.push({path:"/wms/commodity",query:{companyId:e.$store.getters.userId}})}).catch(function(e){h.MessageBox.alert("业务错误："+e.data.message,"警告",{confirmButtonText:"确定",type:"error"})})):this.$alert("请选择严选租赁商品类型","提示",{confirmButtonText:"确定",type:"error"})},handleClose:function(e){this.keywords.splice(this.keywords.indexOf(e),1),this.commodity.keywords=this.keywords.toString()},showInput:function(){var e=this;this.newKeywordVisible=!0,this.$nextTick(function(t){e.$refs.newKeywordInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.newKeyword;e&&(this.keywords.push(e),this.commodity.keywords=this.keywords.toString()),this.newKeywordVisible=!1,this.newKeyword=""},uploadPicUrl:function(e){this.commodity.productIcon=e.data},uploadOverrun:function(){this.$message({type:"error",message:"上传文件个数超出限制!最多上传5张图片!"})},specChanged:function(e){!1===e?(this.specification=[{specification:"规格",value:"标准"}],this.stocks=[{specification:["标准"],salePrice:0,stock:0,url:""}]):(this.specification=[],this.stocks=[])},handlespecificationhow:function(){this.specForm={specification:"",value:""},this.specVisiable=!0},handleSpecificationAdd:function(){for(var e=this.specification.length-1,t=0;t<this.specification.length;t++){var i=this.specification[t];if(i.specification===this.specForm.specification){if(i.value===this.specForm.value)return this.$message({type:"warning",message:"已经存在规格值:"+i.value}),this.specForm={},void(this.specVisiable=!1);e=t}}this.specification.splice(e+1,0,this.specForm),this.specVisiable=!1,this.specToProduct()},handleSpecificationDelete:function(e){var t=this.specification.indexOf(e);this.specification.splice(t,1),this.specToProduct()},specToProduct:function(){if(0!==this.specification.length){var e=[],t=this.specification[0].specification,i=[];i.push(0);for(var o=1;o<this.specification.length;o++){var s=this.specification[o].specification;s===t?i.push(o):(e.push(i),t=s,(i=[]).push(o))}e.push(i);for(var a=0,r=[],c=[],l=e.length,n=0;n<l;n++)c[n]=0;var d=0,m=!1;do{for(var u=[],p=0;p<l;p++){var h=e[p][c[p]];u.push(this.specification[h].value)}r[a]={id:a,specification:u,salePrice:0,stock:0,url:""},a++,d++,c[l-1]=d;for(var f=l-1;f>=0;f--)c[f]>=e[f].length&&(c[f]=0,d=0,f-1>=0&&(c[f-1]=c[f-1]+1));m=!1;for(var y=0;y<l;y++)0!==c[y]&&(m=!0)}while(m);this.stocks=r}},handleProductShow:function(e){this.productForm=r()({},e),this.productVisiable=!0},uploadProductUrl:function(e){this.productForm.url=e.data},handleProductEdit:function(){for(var e=0;e<this.stocks.length;e++){if(this.stocks[e].id===this.productForm.id){this.stocks.splice(e,1,this.productForm);break}}this.productVisiable=!1},handleAttributeShow:function(){this.attributeForm={},this.attributeVisiable=!0},handleAttributeAdd:function(){this.attributes.unshift(this.attributeForm),this.attributeVisiable=!1},handleAttributeDelete:function(e){var t=this.attributes.indexOf(e);this.attributes.splice(t,1)},uploadAvatar:function(e){(new FormData).append("commodityIcon",e.file);e.file.uid},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,i="image/png"===e.type,o=e.size/1024/1024<2;return t||i||this.$message.error("上传图片只能是 JPG或png 格式!"),o||this.$message.error("上传图片大小不能超过 2MB!"),(t||i)&&o},uploadFile:function(e){this.params.append("commodityIcon",e.file)},uploadIconFile:function(e){this.params.append("iconFile",e.file)},handleRemove:function(e,t){for(var i in this.picList)this.picList[i].key===e.uid&&this.picList.splice(i,1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},emptyUpload:function(){var e=this.$refs.upload;e&&(e.length?e.forEach(function(e){e.clearFiles()}):this.$refs.upload.clearFiles())}}}),y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-card",{staticClass:"box-card"},[i("h3",[e._v("严选商品介绍")]),e._v(" "),i("el-form",{ref:"product",attrs:{rules:e.rules,model:e.commodity,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"严选商品名称：",prop:"commodityName"}},[i("el-input",{model:{value:e.commodity.commodityName,callback:function(t){e.$set(e.commodity,"commodityName",t)},expression:"commodity.commodityName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"租赁价格：",prop:"rent"}},[i("el-input",{attrs:{placeholder:"0.00"},model:{value:e.commodity.rent,callback:function(t){e.$set(e.commodity,"rent",t)},expression:"commodity.rent"}},[i("template",{slot:"append"},[e._v("元")])],2)],1),e._v(" "),i("el-form-item",{attrs:{label:"租赁单位：",prop:"unit"}},[i("el-input",{attrs:{placeholder:"小时/ 天 / 月 "},model:{value:e.commodity.unit,callback:function(t){e.$set(e.commodity,"unit",t)},expression:"commodity.unit"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品图片："}},[i("el-upload",{attrs:{action:"#",limit:5,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"before-upload":e.beforeAvatarUpload,"file-list":e.fileList,multiple:"","http-request":e.uploadFile}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),i("el-form-item",{attrs:{label:"商品品牌:",prop:"brand"}},[i("el-input",{model:{value:e.commodity.brand,callback:function(t){e.$set(e.commodity,"brand",t)},expression:"commodity.brand"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品型号：",prop:"model"}},[i("el-input",{model:{value:e.commodity.model,callback:function(t){e.$set(e.commodity,"model",t)},expression:"commodity.model"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品规格：",prop:"specification"}},[i("el-input",{model:{value:e.commodity.specification,callback:function(t){e.$set(e.commodity,"specification",t)},expression:"commodity.specification"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品功率：",prop:"power"}},[i("el-input",{model:{value:e.commodity.power,callback:function(t){e.$set(e.commodity,"power",t)},expression:"commodity.power"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品所在地："}},[i("el-input",{model:{value:e.commodity.location,callback:function(t){e.$set(e.commodity,"location",t)},expression:"commodity.location"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品分类："}},[i("el-select",{model:{value:e.commodity.commodityType,callback:function(t){e.$set(e.commodity,"commodityType",t)},expression:"commodity.commodityType"}},e._l(e.commodityTypeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"严选商品介绍："}},[i("quillEditor",{ref:"myTextEditor",attrs:{options:e.quillOption},model:{value:e.commodity.introduce,callback:function(t){e.$set(e.commodity,"introduce",t)},expression:"commodity.introduce"}})],1)],1)],1),e._v(" "),i("div",{staticClass:"op-container"},[i("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handlePublish}},[e._v("添加")])],1)],1)},staticRenderFns:[]};var b={name:"addProduct",components:{ProductDetail:i("VU/8")(f,y,!1,function(e){i("ZuR7")},null,null).exports}},v={render:function(){var e=this.$createElement;return(this._self._c||e)("product-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]};var g=i("VU/8")(b,v,!1,function(e){i("Q+Er")},null,null);t.default=g.exports},ZuR7:function(e,t){}});
//# sourceMappingURL=22.35a54bec0305f7afcb1f.js.map